<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Applicants - KKFI Admin</title>
  <link rel="stylesheet" href="css/styles.css">
  <style>
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    .page-header h1 { margin: 0; }
    .header-actions {
      display: flex;
      gap: 12px;
    }
    .header-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #fff;
      font-size: 14px;
      cursor: pointer;
      color: #333;
    }
    .header-btn:hover { border-color: #5b5f97; }
    .header-btn svg { width: 16px; height: 16px; }
    
    .table-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      border: 1px solid #eee;
      overflow: hidden;
    }
    .table-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid #f0f0f0;
    }
    .rows-control {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #666;
    }
    .rows-select {
      padding: 6px 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }
    .search-box {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #fff;
    }
    .search-box input {
      border: none;
      outline: none;
      font-size: 14px;
      width: 200px;
    }
    .search-box svg { color: #999; width: 16px; height: 16px; }
    
    .data-table { margin: 0; border-radius: 0; box-shadow: none; }
    .data-table th { 
      background: #fafafa; 
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #666;
    }
    .data-table th, .data-table td { padding: 14px 16px; }
    
    .scholar-cell {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .scholar-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #5b5f97;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 13px;
    }
    
    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
    }
    .status-badge::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }
    .status-badge.compliant { background: #e8f5e9; color: #2e7d32; }
    .status-badge.compliant::before { background: #2e7d32; }
    .status-badge.at-risk { background: #fff3e0; color: #ef6c00; }
    .status-badge.at-risk::before { background: #ef6c00; }
    .status-badge.non-compliant { background: #ffebee; color: #c62828; }
    .status-badge.non-compliant::before { background: #c62828; }
    .status-badge.pending { background: #e3f2fd; color: #1565c0; }
    .status-badge.pending::before { background: #1565c0; }
    
    .view-btn {
      padding: 6px 16px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fff;
      font-size: 13px;
      cursor: pointer;
      color: #333;
      text-decoration: none;
      display: inline-block;
    }
    .view-btn:hover { border-color: #5b5f97; background: #fafaff; }
    
    .checkbox-cell { width: 40px; }
    .checkbox-cell input { width: 16px; height: 16px; cursor: pointer; }
    
    /* Filter Dropdown */
    .filter-dropdown {
      position: relative;
      display: inline-block;
    }
    .filter-menu {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 8px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      min-width: 180px;
      z-index: 100;
      padding: 8px 0;
    }
    .filter-menu.show { display: block; }
    .filter-menu label {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.2s;
    }
    .filter-menu label:hover { background: #f5f5f5; }
    .filter-menu input[type="checkbox"] { width: 16px; height: 16px; }
    
    .header-btn.active { border-color: #5b5f97; background: #f0f1fa; }
  </style>
</head>
<body>
  <div class="layout">
    <div id="sidebar-container"></div>

    <!-- MAIN CONTENT -->
    <main class="content">
      <!-- Page Header -->
      <div class="page-header">
        <h1>Applicants</h1>
        <div class="header-actions">
          <button class="header-btn" id="date-filter">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
            <span id="date-range">All Time</span>
          </button>
          <div class="filter-dropdown">
            <button class="header-btn" id="filter-btn">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/></svg>
              Filter
            </button>
            <div class="filter-menu" id="filter-menu">
              <label><input type="checkbox" value="pending" checked> Pending</label>
              <label><input type="checkbox" value="under-review" checked> Under Review</label>
              <label><input type="checkbox" value="approved" checked> Approved</label>
              <label><input type="checkbox" value="rejected" checked> Rejected</label>
            </div>
          </div>
          <button class="header-btn" id="sort-btn">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"/></svg>
            <span id="sort-label">Sort By A-Z</span>
          </button>
        </div>
      </div>

      <!-- Table Card -->
      <div class="table-card">
        <!-- Table Controls -->
        <div class="table-controls">
          <div class="rows-control">
            <span>Row Per Page</span>
            <select class="rows-select" id="rows-per-page">
              <option value="10">10</option>
              <option value="25">25</option>
              <option value="50">50</option>
            </select>
            <span>Entries</span>
          </div>
          <div class="search-box">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
            <input type="text" id="search-input" placeholder="Search">
          </div>
        </div>

        <!-- Table -->
        <table class="data-table">
          <thead>
            <tr>
              <th class="checkbox-cell"><input type="checkbox" id="select-all"></th>
              <th>ID ↕</th>
              <th>Applicant ↕</th>
              <th>Email ↕</th>
              <th>Date Applied ↕</th>
              <th>Status ↕</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="applicants-tbody">
            <!-- Dynamically populated -->
          </tbody>
        </table>
      </div>

    </main>
  </div>

  <script src="js/sidebar.js"></script>
  <script src="js/data.js"></script>
  <script>
    // Render applicants
    function renderApplicants(filteredApplicants) {
      const tbody = document.getElementById('applicants-tbody');
      
      if (filteredApplicants.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:40px; color:#888;">No applicants found</td></tr>';
        return;
      }

      tbody.innerHTML = filteredApplicants.map(applicant => {
        const statusMap = {
          'pending': { text: 'Pending', class: 'pending' },
          'under-review': { text: 'Under Review', class: 'at-risk' },
          'approved': { text: 'Approved', class: 'compliant' },
          'rejected': { text: 'Rejected', class: 'non-compliant' }
        };
        const status = statusMap[applicant.status] || statusMap['pending'];
        
        return `
          <tr>
            <td class="checkbox-cell"><input type="checkbox"></td>
            <td>${applicant.id}</td>
            <td>
              <div class="scholar-cell">
                <div class="scholar-avatar">${applicant.initials}</div>
                <span>${applicant.firstName} ${applicant.lastName}</span>
              </div>
            </td>
            <td>${applicant.email}</td>
            <td>${applicant.applicationDate}</td>
            <td><span class="status-badge ${status.class}">${status.text}</span></td>
            <td>
              <a href="applicant-details.html?id=${applicant.id}" class="view-btn">View</a>
            </td>
          </tr>
        `;
      }).join('');
    }
    renderApplicants(applicants);

    // Select all checkbox
    document.getElementById('select-all').addEventListener('change', function() {
      const checkboxes = document.querySelectorAll('#applicants-tbody input[type="checkbox"]');
      checkboxes.forEach(cb => cb.checked = this.checked);
    });

    // Filter functionality
    let currentFilters = ['pending', 'under-review', 'approved', 'rejected'];
    let sortAsc = true;

    document.getElementById('filter-btn').addEventListener('click', function(e) {
      e.stopPropagation();
      document.getElementById('filter-menu').classList.toggle('show');
      this.classList.toggle('active');
    });

    document.querySelectorAll('#filter-menu input').forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        currentFilters = Array.from(document.querySelectorAll('#filter-menu input:checked')).map(cb => cb.value);
        applyFiltersAndSort();
      });
    });

    // Sort functionality
    document.getElementById('sort-btn').addEventListener('click', function() {
      sortAsc = !sortAsc;
      document.getElementById('sort-label').textContent = sortAsc ? 'Sort By A-Z' : 'Sort By Z-A';
      this.classList.toggle('active', !sortAsc);
      applyFiltersAndSort();
    });

    function applyFiltersAndSort() {
      let filtered = applicants.filter(a => currentFilters.includes(a.status));
      
      // Apply search
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      if (searchTerm) {
        filtered = filtered.filter(a => 
          a.firstName.toLowerCase().includes(searchTerm) ||
          a.lastName.toLowerCase().includes(searchTerm) ||
          a.id.toLowerCase().includes(searchTerm) ||
          a.email.toLowerCase().includes(searchTerm)
        );
      }

      // Sort by name
      filtered.sort((a, b) => {
        const nameA = `${a.firstName} ${a.lastName}`.toLowerCase();
        const nameB = `${b.firstName} ${b.lastName}`.toLowerCase();
        return sortAsc ? nameA.localeCompare(nameB) : nameB.localeCompare(nameA);
      });

      renderApplicants(filtered);
    }

    // Search listener
    document.getElementById('search-input').addEventListener('input', applyFiltersAndSort);

    // Close filter menu when clicking outside
    document.addEventListener('click', function() {
      document.getElementById('filter-menu').classList.remove('show');
      document.getElementById('filter-btn').classList.remove('active');
    });

    document.getElementById('filter-menu').addEventListener('click', function(e) {
      e.stopPropagation();
    });
  </script>
</body>
</html>
